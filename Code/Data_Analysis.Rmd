---
title: "Final Project: Data Analysis"
author: "Iman Byndloss, Leah Li, and Rachel Williams"
output: html_document
date: "2024-11-29"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

The upcoming analyses seek to answer the following research questions: Do overall daily, monthly, and full study period mammalian species activity differ across three Nashville parks (Beaman, Bells Bend, and Mill Creek)? And do any park attributes (i.e., size and available activities) have a significant impact on species activity?


## Set Up (loading packages and uploading datasets)

```{r,  set up R session, message = FALSE, warning=FALSE}
# Load relevant packages
library(tidyverse)
library(lubridate)
library(dplyr)
library(here)
library(ggplot2)

# Load relevant processed data
Daily_Species_Counts <- read.csv(
  file = here("./Data/Processed/Daily_Species_Counts.csv"),
  stringsAsFactors = TRUE) 

Monthly_Species_Counts <- read.csv(
  file = here("./Data/Processed/Monthly_Species_Counts.csv"),
  stringsAsFactors = TRUE) 

Daily_Merge <- read.csv(
  file = here("./Data/Processed/Daily_Merge.csv"),
  stringsAsFactors = TRUE) 

Montly_Merge <- read.csv(
  file = here("./Data/Processed/Monthly_Merge.csv"),
  stringsAsFactors = TRUE) 
```

# Two-way ANOVA Test 

## Daily Species Activity and Parks

```{r, First ANOVA, message = FALSE, warning=FALSE}
# Perform the two-way ANOVA with interaction
daily_anova_result <- aov(CountAdjusted ~ ParkName * Species, data = Daily_Species_Counts)

# View the ANOVA summary
summary(daily_anova_result)
```

>ANOVA Result Interpretation:

>The two-way ANOVA analysis here evaluated the effects of park location and species type, as well as their interaction, on species activity levels (measured as adjusted counts). The results revealed a significant main effect of park location (F=99.91, p<0.001), indicating that species activity levels varied significantly between parks. Similarly, a highly significant main effect was observed for species type (F=142.86, p<0.001), suggesting that the activity levels differed substantially across the species studied.

>In addition to the main effects, the interaction between park location and species type was also significant (F=127.19, p<0.001). This finding highlights that the effect of park location on species activity is not consistent across all species. In other words, the differences in species activity levels between parks are influenced by the specific species being observed.

>These results suggest that both park-specific factors (e.g., habitat type, management practices) and species-specific traits (e.g., behavior, ecological preferences) play critical roles in determining activity levels. Moreover, the significant interaction effect emphasizes the importance of considering the combined influence of these two factors when analyzing species activity patterns.

### Post-Hoc Test

```{r, Post-Hoc Test after ANOVA, message = FALSE, warning=FALSE}
# If the interaction term is significant, perform a post-hoc test
Daily_Species_Counts$ParkName <- as.factor(Daily_Species_Counts$ParkName)
Daily_Species_Counts$Species <- as.factor(Daily_Species_Counts$Species)

# Tukey's HSD test for the interaction term (ParkName * Species)
library(agricolae)
daily_tukey_result <- TukeyHSD(daily_anova_result, "ParkName:Species")

# Extract significant results
daily_tukey_df <- as.data.frame(daily_tukey_result$`ParkName:Species`)
daily_tukey_df$Comparison <- rownames(daily_tukey_result$`ParkName:Species`)
rownames(daily_tukey_df) <- NULL

# Filter significant comparisons
daily_significant_tukey <- subset(daily_tukey_df, `p adj` < 0.05)

# Print the top 10 significant results
head(daily_significant_tukey, 10)
```

>Post-Hoc Result Interpretation

>1. Species Differences Between Parks: The activity of "Nine-banded Armadillos" exhibited notable variation between parks.  For instance, their activity was significantly lower in Bells Bend Park compared to Mill Creek Park # (diff = -1.53, 95% CI [-1.71, -1.35], p adj < 0.001). Similarly, their activity in Alvin G. Beaman Park was also significantly lower compared to Mill Creek Park  (diff = -1.81, 95% CI [-1.99, -1.63], p adj < 0.001). These results suggest that the habitat or environmental factors in Mill Creek Park are more conducive to higher activity levels for this species.

>2.Within-Park Differences Between Species: In Mill Creek Park, "Muskrat" activity was significantly lower than that of "Eastern Gray Squirrels" (diff = -1.81, 95% CI [-1.99, -1.63], p adj < 0.001). This could indicate competitive dynamics, differences in habitat preference,  or time-specific activity patterns between these species.

>3. Activity Peaks for White-Tailed Deer: The White-tailed Deer in Bells Bend Park showed significantly higher activity compared to other species within the park (diff = 1.15, 95% CI [0.97, 1.32], p adj < 0.001). This finding suggests that this species might be particularly dominant in this park, potentially due to favorable environmental or ecological conditions.

>4. Notable Inter-Park Variation in Woodchuck Activity: The activity of "Woodchucks" was significantly lower in Alvin G. Beaman Park compared to Bells Bend Park (diff = -1.33, 95% CI [-1.51, -1.15], p adj < 0.001). This highlights how habitat differences between parks may influence the presence or detectability of certain species.  Interpretation: These results reveal substantial variation in species activity both within and between parks. Certain species, such as "Nine-banded Armadillos" and "White-tailed Deer," exhibit pronounced activity trends influenced by the park's environmental conditions. The findings emphasize the importance of localized habitat characteristics and interspecies dynamics in shaping activity patterns.

## Monthly Species Activity and Parks

```{r, Second ANOVA, message = FALSE, warning=FALSE}
# Perform the two-way ANOVA with interaction
monthly_anova_result <- aov(CountAdjusted ~ ParkName * Species, data = Monthly_Species_Counts)

# View the ANOVA summary
summary(monthly_anova_result)
```

>ANOVA Result Interpretation:

>The main effect of ParkName was significant (F = 11.81, p = 1.11e-05), indicating that monthly species activity levels vary significantly across different parks. This suggests that environmental factors, habitat characteristics, or management practices unique to each park contribute to these differences.

>Similarly, the main effect of Species was highly significant (F = 16.88, p < 2e-16), demonstrating that monthly activity levels differ substantially among species. This finding reflects species-specific behavior, ecological preferences, or adaptability to certain environments.

>The interaction effect between ParkName and Species was also highly significant (F = 15.03, p < 2e-16). This indicates that the effect of park location on activity levels depends on the species observed, and vice versa. For instance, certain parks may be more conducive to higher activity levels for specific species due to habitat suitability or species-specific ecological requirements.

### Post-Hoc Test

```{r, Post-Hoc Test after second ANOVA, message = FALSE, warning=FALSE}
# If the interaction term is significant, perform a post-hoc test
Monthly_Species_Counts$ParkName <- as.factor(Monthly_Species_Counts$ParkName)
Monthly_Species_Counts$Species <- as.factor(Monthly_Species_Counts$Species)

# Tukey's HSD test for the interaction term (ParkName * Species)
library(agricolae)
monthly_tukey_result <- TukeyHSD(monthly_anova_result, "ParkName:Species")

# Extract significant results
monthly_tukey_df <- as.data.frame(monthly_tukey_result$`ParkName:Species`)
monthly_tukey_df$Comparison <- rownames(monthly_tukey_result$`ParkName:Species`)
rownames(monthly_tukey_df) <- NULL

# Filter significant comparisons
monthly_significant_tukey <- subset(monthly_tukey_df, `p adj` < 0.05)

# Print the top 10 significant results
head(monthly_significant_tukey, 10)
```

>Post-Hoc Result Interpretation

>The Tukey test results on the monthly species activity dataset reveal significant differences in activity levels between species and parks. For instance, the activity of "Eastern Gray Squirrel" in Mill Creek Park was significantly higher compared to "American Beaver" in Bells Bend Park (difference: 50.58, 95% confidence interval: [36.02, 65.14], adjusted p-value: < 0.001). Similarly, "White-tailed Deer" in Bells Bend Park exhibited significantly higher activity compared to "American Beaver" in the same park (difference: 36.93, 95% confidence interval: [22.37, 51.49], adjusted p-value: < 0.001).

>Within Bells Bend Park, "White-tailed Deer" consistently showed higher activity levels compared to other species. For example, their activity was significantly greater than "Bobcat" (difference: 34.83, 95% confidence interval: [20.27, 49.39], adjusted p-value: < 0.001) and "Virginia Opossum" (difference: 36.43, 95% confidence interval: [22.17, 50.99], adjusted p-value: < 0.001). These results indicate that "White-tailed Deer" dominate activity levels within this park.

>Interspecies comparisons across parks also highlighted notable patterns. The activity of "Virginia Opossum" in Bells Bend Park was significantly lower than "Eastern Gray Squirrel" in Mill Creek Park (difference: -47.67, 95% confidence interval: [-62.22, -33.11], adjusted p-value: < 0.001). Similarly, within Mill Creek Park, "White-tailed Deer" showed higher activity compared to "Muskrat" (difference: 36.68, 95% confidence interval: [22.12, 51.24], adjusted p-value: < 0.001).

>Overall, species such as "Eastern Gray Squirrel" in Mill Creek Park and "White-tailed Deer" in Bells Bend Park exhibited the highest activity levels. This may be attributed to favorable environmental conditions or species-specific behaviors in these parks. Conversely, species like "Virginia Opossum" and "American Beaver" consistently exhibited lower activity levels. These findings suggest that ecological or habitat-specific factors significantly influence species activity patterns across parks.

# Two sample T-test

## Daily Species Activity 

```{r}
# Independently filter for three potentially important species: Eastern Gray Squirrel, White-tailed Deer, and Coyote
dmSquirrel <- Daily_Merge %>% 
  filter(Species == "Eastern Gray Squirrel") 
dmDeer <- Daily_Merge %>% 
  filter(Species == "White-tailed Deer") 
dmCoyote <- Daily_Merge %>% 
  filter(Species == "Coyote")
```

### Park Classification (Regional vs Community)
```{r}
# Run a t-test for each species
SQ_t_test_class <- t.test(CountAdjusted ~ Classification, data = dmSquirrel)
SQ_t_test_class

D_t_test_class <- t.test(CountAdjusted ~ Classification, data = dmDeer)
D_t_test_class

C_t_test_class <- t.test(CountAdjusted ~ Classification, data = dmCoyote)
C_t_test_class

#Squirrel and Deer both significant, coyote not. 
```

### Park Size (>1000ac vs <1000ac)
```{r}
# Run a t-test for each species
SQ_t_test_size <- t.test(CountAdjusted ~ Size, data = dmSquirrel)
SQ_t_test_size

D_t_test_size <- t.test(CountAdjusted ~ Size, data = dmDeer)
D_t_test_size

C_t_test_size <- t.test(CountAdjusted ~ Size, data = dmCoyote)
C_t_test_size
```

### Disruptive Activity, i.e., mountain biking, camping and fishing (Yes vs No)
```{r}
# Run a t-test for each species
SQ_t_test_disrupt <- t.test(CountAdjusted ~ DisruptiveActivities, data = dmSquirrel)
SQ_t_test_disrupt

D_t_test_disrupt <- t.test(CountAdjusted ~ DisruptiveActivities, data = dmDeer)
D_t_test_disrupt

C_t_test_disrupt <- t.test(CountAdjusted ~ DisruptiveActivities, data = dmCoyote)
C_t_test_disrupt
```
